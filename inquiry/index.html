<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact | nihongotext.com</title>
  <style>
    /* ===== Brand tokens (match top page) ===== */
    :root{
      --brand:#ef4444;           /* accent line / buttons */
      --fg:#111;
      --muted:#6b7280;
      --bg:#fff;
      --border:#e5e7eb;
      --chip:#f8fafc;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,ui-sans-serif;line-height:1.5}
    a{color:inherit;text-decoration:none}
    .container{max-width:980px;margin:0 auto;padding:0 16px}

    /* ===== Header ===== */
    .site-header{position:sticky;top:0;z-index:30;background:#fff;border-bottom:2px solid var(--brand)}
    .site-header .bar{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{font-weight:800;letter-spacing:.2px}
    .brand .dot{color:var(--brand)}
    nav ul{display:flex;gap:20px;list-style:none;margin:0;padding:0}
    nav a{opacity:.8}
    nav a.active, nav a:hover{opacity:1}
    .actions{display:flex;align-items:center;gap:8px}
    .pill{padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--chip);cursor:pointer;font-size:13px}
    .pill.active{background:var(--fg);color:#fff;border-color:var(--fg)}
    .cta{padding:8px 12px;border:1px solid var(--brand);color:#fff;background:var(--brand);border-radius:10px;font-weight:600}

    /* ===== Page title ===== */
    .page-head{padding:24px 0}
    .page-head h1{margin:0 0 6px;font-size:28px}
    .crumbs{font-size:13px;color:var(--muted)}

    /* ===== Card & form ===== */
    .card{border:1px solid var(--border);border-radius:14px;background:#fff}
    .card.body{padding:18px}
    label{display:block;font-size:12px;color:var(--muted);margin:12px 0 6px}
    input,textarea{width:100%;font:inherit;padding:10px;border:1px solid var(--border);border-radius:8px;background:#fff}
    textarea{min-height:180px;resize:vertical}
    .row{display:flex;flex-wrap:wrap;align-items:center;gap:10px;margin-top:14px}
    .btn{padding:10px 16px;border-radius:10px;border:1px solid var(--border);cursor:pointer}
    .btn-primary{background:var(--brand);border-color:var(--brand);color:#fff;font-weight:600}
    .btn-ghost{background:#fff}
    .note{font-size:12px;color:var(--muted);margin-top:8px}
    .msg-ok{color:#10b981;font-weight:600}
    .msg-ng{color:var(--brand);font-weight:600}

    /* ===== Footer ===== */
    .site-footer{margin-top:36px;border-top:2px solid var(--brand);padding:18px 0;color:var(--muted)}
    .foot-rows{display:flex;justify-content:center;gap:16px;margin:8px 0 6px}
    .ico{width:28px;height:28px;display:inline-grid;place-items:center;border:1px solid var(--border);border-radius:999px}
    .copyright{text-align:center;font-size:12px}

    @media (max-width:640px){
      nav ul{gap:14px}
      .page-head h1{font-size:24px}
    }
  </style>

  <!-- reCAPTCHA v2 (checkbox; async/defers are required for stable render) -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
  <!-- ===== Header ===== -->
  <header class="site-header">
    <div class="container bar">
      <a href="/" class="brand">nihongo<span class="dot">text</span>.com</a>
      <nav aria-label="Primary">
        <ul>
          <li><a href="/" data-i18n="nav_home">Home</a></li>
          <li><a href="/blog/" data-i18n="nav_blog">Blog</a></li>
          <li><a class="active" href="/inquiry/" data-i18n="nav_contact">Contact</a></li>
        </ul>
      </nav>
      <div class="actions">
        <!-- Quick contact icon (same to Contact) -->
        <a class="ico" href="/inquiry/" title="Contact">‚úâÔ∏è</a>
        <!-- Language toggle -->
        <button id="btnEn" class="pill">English</button>
        <button id="btnJa" class="pill">Êó•Êú¨Ë™û</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Page head -->
    <div class="page-head">
      <div class="crumbs" id="crumbs">Home / Contact</div>
      <h1 id="hContact">Contact</h1>
    </div>

    <!-- Hidden iframe for cross-origin POST completion detection -->
    <iframe name="submit_iframe" id="submit_iframe" style="display:none"></iframe>

    <!-- Contact card -->
    <section class="card body">
      <form
        id="contactForm"
        target="submit_iframe"
        method="POST"
        action="https://script.google.com/macros/s/AKfycbzHvm3JmrYzJChzIPJJIR7PsAMmMOaPBKXVEyBXLeLQ_7mMrhCOJ_DdWxE75TVxWwWZvQ/exec"
      >
        <label for="name" id="lbName">Name</label>
        <input id="name" name="name" autocomplete="name" placeholder="Your name" />

        <label for="email" id="lbEmail">Email</label>
        <input id="email" name="email" type="email" autocomplete="email" placeholder="you@email.com" />

        <label for="subject" id="lbSubject">Subject</label>
        <input id="subject" name="subject" placeholder="What is this about?" />

        <label for="message" id="lbMessage">Message</label>
        <textarea id="message" name="message" placeholder="Write your message‚Ä¶"></textarea>

        <!-- reCAPTCHA token will be sent via hidden input -->
        <input type="hidden" id="token" name="token" />

        <div class="row">
          <!-- v2 checkbox widget -->
          <div class="g-recaptcha" data-sitekey="6LcRKvArAAAAAFVmY21y9o_hwTszHwzp3bgRXtBV"></div>
          <button type="button" id="btnCancel" class="btn btn-ghost">Cancel</button>
          <button type="submit" id="btnSend" class="btn btn-primary">Send</button>
        </div>

        <div class="note" id="rcNote">
          reCAPTCHA and Google‚Äôs
          <a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a> and
          <a href="https://policies.google.com/terms" target="_blank" rel="noopener">Terms of Service</a> apply.
        </div>
        <div class="note" id="msg" aria-live="polite"></div>
      </form>
    </section>
  </main>

  <!-- ===== Footer ===== -->
  <footer class="site-footer">
    <div class="container">
      <div class="foot-rows" aria-label="Quick links">
        <a class="ico" href="/" title="Home">üè†</a>
        <a class="ico" href="/blog/" title="Blog">üì∞</a>
        <a class="ico" href="/inquiry/" title="Contact">‚úâÔ∏è</a>
      </div>
      <div class="copyright">¬© 2025 nihongotext.com</div>
    </div>
  </footer>

  <script>
    /* ===== Language (EN default; toggle via ?lang=ja/en) ===== */
    const params = new URL(location.href).searchParams;
    let LANG = params.get('lang') === 'ja' ? 'ja' : 'en';

    const T = {
      en: {
        crumbs: 'Home / Contact',
        contact: 'Contact',
        name: 'Name',
        email: 'Email',
        subject: 'Subject',
        message: 'Message',
        cancel: 'Cancel',
        send: 'Send',
        sentok: 'Your message has been sent. Thank you!',
        sentng: 'Failed to send. Please try again later.',
        need: 'Please check the reCAPTCHA box.',
        nav_home: 'Home', nav_blog: 'Blog', nav_contact: 'Contact'
      },
      ja: {
        crumbs: '„Éõ„Éº„É† / „ÅäÂïè„ÅÑÂêà„Çè„Åõ',
        contact: '„ÅäÂïè„ÅÑÂêà„Çè„Åõ',
        name: '„ÅäÂêçÂâç',
        email: '„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ',
        subject: '‰ª∂Âêç',
        message: '„É°„ÉÉ„Çª„Éº„Ç∏',
        cancel: '„Ç≠„É£„É≥„Çª„É´',
        send: 'ÈÄÅ‰ø°',
        sentok: 'ÈÄÅ‰ø°„Åó„Åæ„Åó„Åü„ÄÇ„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ',
        sentng: 'ÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇÊôÇÈñì„Çí„Åä„ÅÑ„Å¶ÂÜçÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ',
        need: 'reCAPTCHA „Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
        nav_home: '„Éõ„Éº„É†', nav_blog: '„Éñ„É≠„Ç∞', nav_contact: '„ÅäÂïè„ÅÑÂêà„Çè„Åõ'
      }
    };

    function applyLang(){
      const t = T[LANG];
      document.getElementById('crumbs').textContent = t.crumbs;
      document.getElementById('hContact').textContent = t.contact;
      document.getElementById('lbName').textContent = t.name;
      document.getElementById('lbEmail').textContent = t.email;
      document.getElementById('lbSubject').textContent = t.subject;
      document.getElementById('lbMessage').textContent = t.message;
      document.getElementById('btnCancel').textContent = t.cancel;
      document.getElementById('btnSend').textContent = t.send;

      // nav labels
      const navMap = { nav_home: 'nav_home', nav_blog:'nav_blog', nav_contact:'nav_contact' };
      Object.keys(navMap).forEach(key=>{
        const el = document.querySelector(`[data-i18n="${key}"]`);
        if (el) el.textContent = t[key];
      });

      // pills
      document.getElementById('btnEn').classList.toggle('active', LANG==='en');
      document.getElementById('btnJa').classList.toggle('active', LANG==='ja');

      // persist to URL (no reload)
      const url = new URL(location.href);
      url.searchParams.set('lang', LANG);
      history.replaceState(null, '', url.toString());
    }
    document.getElementById('btnEn').onclick = ()=>{ LANG='en'; applyLang(); };
    document.getElementById('btnJa').onclick = ()=>{ LANG='ja'; applyLang(); };
    applyLang();

    /* ===== Submit flow (same as OK working version) ===== */
    const form = document.getElementById('contactForm');
    const msg  = document.getElementById('msg');
    const btnSend = document.getElementById('btnSend');
    const btnCancel = document.getElementById('btnCancel');
    const iframe = document.getElementById('submit_iframe');

    // GAS ÂøúÁ≠î„Çí iframe „ÅÆ load „ÅßÊ§úÁü• ‚Üí ÊàêÂäüË°®Á§∫
    iframe.addEventListener('load', () => {
      btnSend.disabled = false;
      msg.textContent = T[LANG].sentok;
      msg.className = 'note msg-ok';
      form.reset();
      if (window.grecaptcha) grecaptcha.reset();
    });

    form.addEventListener('submit', (ev) => {
      const token = window.grecaptcha ? grecaptcha.getResponse() : '';
      if (!token){
        ev.preventDefault();
        msg.textContent = T[LANG].need;
        msg.className = 'note msg-ng';
        return;
      }
      document.getElementById('token').value = token;
      btnSend.disabled = true;
      msg.textContent = '';
      msg.className = 'note';
      // ‰ª•Èôç„ÅØ„Éñ„É©„Ç¶„Ç∂„Åå„Åù„ÅÆ„Åæ„Åæ„ÇØ„É≠„Çπ„Ç™„É™„Ç∏„É≥POSTÔºàCORS‰∏çË¶ÅÔºâ
    });

    btnCancel.addEventListener('click', () => {
      form.reset();
      msg.textContent = '';
      msg.className = 'note';
      if (window.grecaptcha) grecaptcha.reset();
    });

    /* ===== Defensive reCAPTCHA re-render (rare, but helps some caches) ===== */
    window.addEventListener('pageshow', () => {
      if (window.grecaptcha && document.querySelector('.g-recaptcha div iframe') == null) {
        grecaptcha.render(document.querySelector('.g-recaptcha'), {
          sitekey: '6LcRKvArAAAAAFVmY21y9o_hwTszHwzp3bgRXtBV'
        });
      }
    });
  </script>
</body>
</html>
