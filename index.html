<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>nihongotext.com</title>
<link rel="icon" href="/favicon.ico" />

<!-- Google Analytics (GA4) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9QSHWJE0HZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-9QSHWJE0HZ', { send_page_view:false });
</script>

<!-- âœ… AdSense æ‰€æœ‰æ¨©ç¢ºèªã®ã¿ï¼ˆé…ä¿¡ã¯ã—ãªã„ï¼‰ -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2358198194205084" crossorigin="anonymous"></script>

<style>
/* ===== Theme: æœ±Ã—ç™½ï¼ˆçµ±ä¸€ï¼‰ ===== */
:root{
  --shu:#e6462d; --shu-deep:#c13727; --shu-tint:#fff2ef;
  --ink:#1f2937; --muted:#6b7280; --line:#f1f5f9;
  --chip:#f8fafc; --card:#fff7f6; --ok:#16a34a;
}
*{box-sizing:border-box}
html,body{margin:0;background:#fff;color:var(--ink);
  font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic UI","Meiryo",sans-serif}
a{color:inherit;text-decoration:none}
button{cursor:pointer}

.wrap{max-width:1100px;margin:0 auto;padding:0 16px}
.topbar{border-top:4px solid var(--shu);border-bottom:1px solid var(--shu-tint);background:#fff}
.brandbar{display:flex;gap:14px;align-items:center;padding:14px 0}
.brand{font-weight:900;font-size:26px;color:var(--shu)}
.small-dot{color:#222}
.beta{color:var(--muted);font-size:12px}
.header-right{margin-left:auto;display:flex;gap:10px;align-items:center}
.learnedIcon{display:inline-flex;gap:6px;align-items:center;border:1px solid var(--shu);color:var(--shu);
  background:#fff;border-radius:999px;padding:6px 10px;font-weight:700}

.footer{border-top:1px solid var(--shu-tint);background:#fff}
.footer-inner{padding:16px 0;display:flex;gap:10px;align-items:center;justify-content:center;color:var(--muted);font-size:12px}

.controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:18px 0}
select,input[type="text"]{height:40px;border:1px solid var(--line);border-radius:10px;padding:0 12px;background:#fff}
.grow{flex:1}
.btn{border:1px solid var(--shu);color:var(--shu);background:#fff;border-radius:10px;padding:8px 12px;font-weight:700}
.btn.ok{background:var(--shu);color:#fff}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{border:1px solid var(--line);background:#f8fafc;border-radius:999px;padding:8px 12px;font-weight:700}
.chip.active{border-color:var(--shu);background:#fde3df}

.grid{display:grid;grid-template-columns:1fr;gap:12px}
.card{background:var(--card);border:1px solid #f1cbc6;border-radius:14px;overflow:hidden}
.card.learned{background:#eefbf1;border-color:#cceedd}
.head{display:flex;gap:10px;align-items:center;padding:10px 12px;background:#fff;border-bottom:1px dashed #f0d7d4}
.num{font-weight:800;color:var(--shu)}
.tags{display:flex;gap:6px;flex-wrap:wrap}
.tag{font-size:13px;background:#fff;border:1px solid #f0d7d4;border-radius:8px;padding:3px 8px}
.content{padding:12px 14px}
.line{margin:6px 0}
.ja{font-weight:800}
.kana,.ro,.en{opacity:.9}

.pager{display:flex;gap:8px;align-items:center;justify-content:center;margin:16px 0 10px}
.pagebtn{border:1px solid var(--line);background:#fff;border-radius:8px;padding:6px 10px}
.pagebtn.active{border-color:var(--shu);color:var(--shu);font-weight:800}

/* ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—åºƒå‘Šï¼ˆãƒã‚¦ã‚¹ã‚¢ãƒ‰ï¼‰ */
.admask{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:90}
.admask.show{display:flex}
.ad{background:#fff;border-radius:16px;max-width:520px;width:min(92vw,520px);padding:18px;border:2px solid var(--shu)}
.ad .x{float:right;border:1px solid var(--shu);color:var(--shu);background:#fff;border-radius:8px;padding:4px 9px}
.ad h3{margin:4px 0 8px}
.ad small{color:var(--muted)}
</style>
</head>
<body>

<!-- ===== Headerï¼ˆpartials ã‚’æ³¨å…¥ï¼‰ ===== -->
<div class="topbar">
  <div id="site-header" class="wrap brandbar">
    <!-- èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ -->
    <a href="/" class="brand">nihongotext<span class="small-dot">.com</span></a>
    <span class="beta">== beta version ==</span>
    <div class="header-right">
      <button id="openLearnedTop" class="learnedIcon" type="button">ğŸ“˜ è¦šãˆãŸä¸€è¦§</button>
    </div>
  </div>
</div>

<main class="wrap">
  <!-- æ“ä½œUI -->
  <div class="controls">
    <label>Level
      <select id="levelSel">
        <option>N5</option><option>N4</option><option>N3</option><option>N2</option><option>N1</option>
      </select>
    </label>
    <div class="chips" id="posChips" role="tablist" aria-label="Parts of Speech"></div>
    <input id="kw" type="text" placeholder="Search keywordâ€¦" />
    <div class="grow"></div>
    <button id="printBtn" class="btn" type="button">Print Learned</button>
  </div>

  <!-- â€» ä¸Šä¸‹ã® AdSense æ ã¯å‰Šé™¤ï¼ˆãƒšãƒ¼ã‚¸ãƒ£ãƒ¼æ™‚ã®ã¿ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤ºï¼‰ -->

  <div id="meta" style="color:var(--muted);font-size:13px;margin:4px 0 10px"></div>
  <div id="list" class="grid" aria-live="polite"></div>
  <div id="pager" class="pager"></div>
</main>

<!-- ===== Footerï¼ˆpartials ã‚’æ³¨å…¥ï¼‰ ===== -->
<div class="footer">
  <div id="site-footer" class="wrap footer-inner">Â© 2025 nihongotext.com</div>
</div>

<!-- ===== è¦šãˆãŸä¸€è¦§ãƒ¢ãƒ¼ãƒ€ãƒ« ===== -->
<div id="learnedModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="learnedTitle" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.4);z-index:80">
  <div class="panel" style="background:#fff;border-radius:14px;max-width:720px;width:min(92vw,720px);padding:16px">
    <button class="close" id="closeLearned" style="float:right;border:1px solid #e5e7eb;padding:4px 8px;border-radius:8px;background:#fff">Close</button>
    <h3 id="learnedTitle" style="margin:0 0 8px">è¦šãˆãŸä¸€è¦§ / Learned</h3>
    <div id="learnedBody" class="list-simple" style="border-top:1px dashed #ddd;margin-top:10px"></div>
    <div class="tools" style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button id="clearLearned" class="btn">Clear</button>
      <button id="printLearned" class="btn ok">Print</button>
    </div>
  </div>
</div>

<!-- ===== ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¯ãƒªãƒƒã‚¯æ™‚ã ã‘å‡ºã™ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—åºƒå‘Šï¼ˆãƒã‚¦ã‚¹ã‚¢ãƒ‰ï¼‰ ===== -->
<div id="adMask" class="admask" aria-hidden="true">
  <div class="ad" role="dialog" aria-label="Promotion">
    <button class="x" id="adClose" aria-label="Close">Ã—</button>
    <h3>nihongotext.com ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›</h3>
    <p>æœ€æ–°ã®è¨˜äº‹ã‚„è¿½åŠ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ <a href="/blog/" style="text-decoration:underline">ãŠçŸ¥ã‚‰ã›ãƒšãƒ¼ã‚¸</a> ã‚’ãƒã‚§ãƒƒã‚¯ï¼</p>
    <small>â€»ã“ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã¯è‡ªç¤¾å‘ŠçŸ¥ï¼ˆãƒã‚¦ã‚¹ã‚¢ãƒ‰ï¼‰ã§ã™ã€‚</small>
  </div>
</div>

<script>
/* ========= Partials èª­ã¿è¾¼ã¿ï¼ˆå®Œäº†ã¾ã§å¾…ã¤ï¼‰ ========= */
async function injectPartials(){
  const hdr = document.getElementById('site-header');
  const ftr = document.getElementById('site-footer');
  try{
    const h = await fetch('/partials/header.html',{cache:'no-store'}).then(r=>r.ok?r.text():Promise.reject());
    hdr.innerHTML = h;
  }catch(_){
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ—¢ã«åˆæœŸHTMLã‚’è¡¨ç¤ºæ¸ˆã¿ï¼‰
  }
  try{
    const f = await fetch('/partials/footer.html',{cache:'no-store'}).then(r=>r.ok?r.text():Promise.reject());
    ftr.innerHTML = f;
  }catch(_){
    // æ—¢å®šã®ç°¡æ˜“ãƒ•ãƒƒã‚¿ãƒ¼ã‚’ç¶­æŒ
  }

  // ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ãƒ•ãƒƒã‚¿ãƒ¼ã«ã€Œè¦šãˆãŸä¸€è¦§ã€ãƒœã‚¿ãƒ³ãŒãªã‘ã‚Œã°è¿½åŠ 
  if(!document.getElementById('openLearnedTop')){
    const btn=document.createElement('button');
    btn.id='openLearnedTop'; btn.className='learnedIcon'; btn.type='button'; btn.textContent='ğŸ“˜ è¦šãˆãŸä¸€è¦§';
    // å³å´ã«ç½®ã
    const host = hdr.querySelector('.header-right') || hdr.appendChild(Object.assign(document.createElement('div'),{style:"margin-left:auto"}));
    host.appendChild(btn);
  }
  document.getElementById('openLearnedTop').addEventListener('click', openLearned);
}

/* ========= ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º ========= */
const POS = [
  {k:'nouns', file:'nouns.json', ja:'åè©', en:'Nouns'},
  {k:'verbs', file:'verbs.json', ja:'å‹•è©', en:'Verbs'},
  {k:'iadj',  file:'iadj.json',  ja:'ã„å½¢å®¹è©', en:'i-adjectives'},
  {k:'naadj', file:'naadj.json', ja:'ãªå½¢å®¹è©', en:'na-adjectives'},
  {k:'advs',  file:'adverbs.json', ja:'å‰¯è©', en:'Adverbs'},
  {k:'prt',   file:'particles.json', ja:'åŠ©è©', en:'Particles'},
  {k:'conj',  file:'conjunctions.json', ja:'æ¥ç¶šè©', en:'Conjunctions'},
  {k:'interj',file:'interjections.json', ja:'æ„Ÿå‹•è©', en:'Interjections'},
  {k:'nums',  file:'numerals.json', ja:'æ•°è©+åŠ©æ•°è©', en:'Numerals'},
  {k:'pat',   file:'patterns.json', ja:'æ–‡å‹', en:'Patterns'},
];
let level='N5', posKey='verbs', page=1;
const PAGE_SIZE=5;
let lastData=[];

const kw=document.getElementById('kw');
kw.addEventListener('input', ()=>{page=1;renderList(lastData);});

document.getElementById('levelSel').addEventListener('change', e=>{
  level=e.target.value; page=1; loadAndRender(true,'level');
});

const chips = document.getElementById('posChips');
function buildChips(){
  chips.innerHTML='';
  POS.forEach(p=>{
    const b=document.createElement('button');
    b.className='chip'+(p.k===posKey?' active':'');
    b.textContent=`${p.ja} / ${p.en}`;
    b.onclick=()=>{posKey=p.k;page=1;buildChips();loadAndRender(true,'pos');};
    chips.appendChild(b);
  });
}

function buildPath(){return `/data/json/${level}/${POS.find(p=>p.k===posKey).file}`;}

const SAMPLE=[{"id":"demo-001","ja":"ä¼šã†","kana":"ã‚ã†","ro":"au","en":"meet",
  "examples":[
    {"ja":"æ¯é€±å‹é”ã«ä¼šã„ã¾ã™ã€‚","kana":"ã¾ã„ã—ã‚…ã† ã¨ã‚‚ã ã¡ ã« ã‚ã„ã¾ã™ã€‚","ro":"maishuu tomodachi ni aimasu.","en":"I meet my friends every week."},
    {"ja":"é§…ã§å…ˆç”Ÿã«ä¼šã„ã¾ã—ãŸã€‚","kana":"ãˆã ã§ ã›ã‚“ã›ã„ ã« ã‚ã„ã¾ã—ãŸã€‚","ro":"eki de sensei ni aimashita.","en":"I met my teacher at the station."}
  ]},
  {"id":"demo-002","ja":"é–‹ã‘ã‚‹","kana":"ã‚ã‘ã‚‹","ro":"akeru","en":"open",
  "examples":[{"ja":"çª“ã‚’é–‹ã‘ã¾ã™ã€‚","kana":"ã¾ã© ã‚’ ã‚ã‘ã¾ã™ã€‚","ro":"mado o akemasu.","en":"I open the window."}]}];

async function loadAndRender(showAd){
  document.getElementById('meta').textContent=`Level: ${level} â€¢ Part: ${POS.find(p=>p.k===posKey).en}`;
  try{
    const r=await fetch(buildPath(),{cache:'no-store'});
    if(!r.ok) throw new Error('HTTP '+r.status);
    lastData=await r.json();
  }catch(_){ lastData=SAMPLE; }
  renderList(lastData);

  // GA page_view
  try{
    gtag('event','page_view',{
      page_title: `${level} / ${posKey}`,
      page_location: location.href,
      page_path: location.pathname + location.search
    });
  }catch(_){}
}

/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ãƒ»æç”» */
const list=document.getElementById('list');
const pager=document.getElementById('pager');

function filtered(data){
  const t=kw.value.trim().toLowerCase();
  if(!t) return data;
  return data.filter(x=>{
    const hay=[x.ja||'',x.kana||'',x.ro||'',x.en||'',...(x.examples||[]).flatMap(e=>[e.ja||'',e.kana||'',e.ro||'',e.en||''])].join(' ').toLowerCase();
    return hay.includes(t);
  });
}
function paginate(data){
  const total=Math.max(1,Math.ceil(data.length/PAGE_SIZE));
  if(page>total)page=total;
  const start=(page-1)*PAGE_SIZE;
  const rows=data.slice(start,start+PAGE_SIZE);

  pager.innerHTML='';
  const prev=pageBtn('Prev',()=>{page--;renderList(lastData,true);showAdPopup();});
  prev.disabled=page<=1; pager.appendChild(prev);

  for(let i=1;i<=total;i++){
    const b=pageBtn(String(i),()=>{page=i;renderList(lastData,true);showAdPopup();});
    if(i===page) b.classList.add('active');
    pager.appendChild(b);
  }
  const next=pageBtn('Next',()=>{page++;renderList(lastData,true);showAdPopup();});
  next.disabled=page>=total; pager.appendChild(next);
  return rows;
}
function pageBtn(t,fn){const b=document.createElement('button');b.className='pagebtn';b.textContent=t;b.onclick=fn;return b;}

function renderList(data){
  list.innerHTML='';
  const rows=paginate(filtered(data));
  let idx=(page-1)*PAGE_SIZE;
  rows.forEach(item=>{
    idx++;
    const card=document.createElement('article'); card.className='card';
    if(learnedSet().has(item.id)) card.classList.add('learned');

    const head=document.createElement('div'); head.className='head';
    const num=div('num',idx+'.');
    const tags=div('tags','');
    ['ja','kana','ro','en'].forEach(k=>{const s=document.createElement('span');s.className='tag';s.textContent=item[k]||'';tags.appendChild(s);});
    const act=document.createElement('button'); act.className='btn'; act.textContent= learnedSet().has(item.id) ? 'è¦šãˆãŸã‚’æˆ»ã™' : 'è¦šãˆãŸ';
    act.onclick=()=>toggleLearned(item,card,act);
    head.append(num,tags,act);

    const body=div('content',''); body.dataset.examples='1';
    (item.examples||[]).forEach(ex=>{
      const block=div('line',''); 
      block.innerHTML = `
        <div class="ja">${ex.ja||''}</div>
        <div class="kana">${ex.kana||''}</div>
        <div class="ro">${ex.ro||''}</div>
        <div class="en">${ex.en||''}</div>`;
      body.appendChild(block);
    });
    card.append(head,body); list.appendChild(card);
    if(learnedSet().has(item.id)) body.style.display='none';
  });
}
function div(cls,txt){const d=document.createElement('div');d.className=cls; if(txt!=null)d.textContent=txt; return d;}

/* è¦šãˆãŸ */
const LS_KEY = ()=>`nt_learned_${level}_${posKey}`;
function learnedSet(){return new Set(JSON.parse(localStorage.getItem(LS_KEY())||'[]'));}
function setLearned(s){localStorage.setItem(LS_KEY(),JSON.stringify([...s]));}
function toggleLearned(item,card,btnEl){
  const s=learnedSet();
  const body = card.querySelector('[data-examples]');
  if(s.has(item.id)){ s.delete(item.id); card.classList.remove('learned'); body.style.display=''; if(btnEl) btnEl.textContent='è¦šãˆãŸ'; }
  else { s.add(item.id); card.classList.add('learned'); body.style.display='none'; if(btnEl) btnEl.textContent='è¦šãˆãŸã‚’æˆ»ã™'; }
  setLearned(s);
}

/* è¦šãˆãŸãƒ¢ãƒ¼ãƒ€ãƒ« */
const learnedModal=document.getElementById('learnedModal');
function openLearned(){
  const s=learnedSet(); const body=document.getElementById('learnedBody'); body.innerHTML='';
  const rows=(lastData||[]).filter(x=>s.has(x.id));
  if(rows.length===0){ body.innerHTML='<div class="row" style="color:#6b7280">ï¼ˆã¾ã ã‚ã‚Šã¾ã›ã‚“ï¼‰</div>'; }
  else rows.forEach((x,i)=>{const r=document.createElement('div');r.className='row';r.textContent=`${i+1}. ${x.ja} / ${x.kana} / ${x.ro} â€” ${x.en}`;body.appendChild(r);});
  learnedModal.style.display='flex';
}
document.getElementById('closeLearned').onclick=()=>learnedModal.style.display='none';
document.getElementById('learnedModal').addEventListener('click',e=>{if(e.target===learnedModal) learnedModal.style.display='none';});
document.getElementById('clearLearned').onclick=()=>{localStorage.setItem(LS_KEY(),'[]');openLearned();};
document.getElementById('printLearned').onclick=()=>{
  const s=learnedSet(); if(!s.size){alert('No learned items.');return;}
  const w=open('','_blank'); const rows=(lastData||[]).filter(x=>s.has(x.id));
  w.document.write('<!doctype html><meta charset="utf-8"><title>Learned</title><style>body{font:14px system-ui;padding:20px}.row{border-bottom:1px dashed #ccc;padding:6px 0}</style><h1>Learned</h1>');
  rows.forEach((x,i)=>w.document.write(`<div class="row">${i+1}. <strong>${x.ja}</strong> / ${x.kana} / ${x.ro} â€” ${x.en}</div>`));
  w.document.close(); w.print();
};

/* ===== ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã¿å‡ºã™ãƒã‚¦ã‚¹ã‚¢ãƒ‰ï¼ˆAdSenseã¯ä½¿ã‚ãªã„ï¼‰ ===== */
const adMask=document.getElementById('adMask'), adClose=document.getElementById('adClose');
function showAdPopup(){ adMask.classList.add('show'); }
adClose.onclick=()=>adMask.classList.remove('show');
adMask.addEventListener('click',e=>{ if(e.target===adMask) adMask.classList.remove('show'); });

/* ===== åˆæœŸåŒ–ï¼špartials èª­ã¿è¾¼ã¿å¾Œã«è¡¨ç¤ºé–‹å§‹ ===== */
(async function init(){
  await injectPartials();
  buildChips();
  document.getElementById('printBtn').addEventListener('click', openLearned);
  await loadAndRender(false);
})();
</script>
</body>
</html>
