<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JLPT Words | nihongotext.com</title>
  <link rel="icon" href="/favicon.ico" />
  <base href="/" />

  <!-- GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9QSHWJE0HZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-9QSHWJE0HZ', { send_page_view:false });
  </script>

  <link rel="stylesheet" href="/assets/style.css" />
  <script src="/assets/common.js" defer></script>
</head>
<body>

  <!-- Header -->
  <div id="header"></div>

  <main>
    <h1>JLPT — Words</h1>

    <div class="selector">
      <label>Level
        <select id="level">
          <option value="N5">N5</option>
          <option value="N4">N4</option>
          <option value="N3">N3</option>
          <option value="N2">N2</option>
          <option value="N1">N1</option>
        </select>
      </label>

      <label>Part
        <select id="part">
          <option value="verbs">verbs</option>
          <option value="nouns">nouns</option>
          <option value="adjectives-i">adjectives-i</option>
          <option value="adjectives-na">adjectives-na</option>
          <option value="adverbs">adverbs</option>
          <option value="numerals">numerals</option>
          <option value="particles">particles</option>
          <option value="conjunctions">conjunctions</option>
          <option value="interjections">interjections</option>
          <option value="patterns">patterns</option>
        </select>
      </label>
    </div>

    <div class="display-options">
      <label><input type="checkbox" id="showKanji" checked /> Nihongo（漢字＋ふりがな）</label>
      <label><input type="checkbox" id="showHiragana" /> Hiragana</label>
      <label><input type="checkbox" id="showRomaji" /> Alphabet (romaji)</label>
      <label><input type="checkbox" id="showEnglish" checked /> English</label>
    </div>

    <div id="content" class="content-area"></div>
  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <script type="module">
    // --- Header & Footer 読み込み ---
    document.getElementById('header').innerHTML = await (await fetch('/partials/header.html')).text();
    document.getElementById('footer').innerHTML = await (await fetch('/partials/footer.html')).text();

    const levelSelect = document.getElementById('level');
    const partSelect = document.getElementById('part');
    const content = document.getElementById('content');

    levelSelect.addEventListener('change', reloadData);
    partSelect.addEventListener('change', reloadData);

    async function reloadData() {
      const level = levelSelect.value;
      const part = partSelect.value;
      const url = `/data/json/${level}/${part}.json`;

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error('File not found');
        const data = await res.json();
        renderList(data);
      } catch (err) {
        content.innerHTML = `<div class="error">This file is not valid JSON.<br>${url}</div>`;
      }
    }

    function renderList(data) {
      let html = '';
      data.forEach((item, i) => {
        html += `
          <div class="word-item">
            <div class="word-title">
              <b>${i + 1}. ${item.ja}</b> (${item.ro})
            </div>
            <div class="word-meaning">${item.en}</div>
          </div>`;
      });
      content.innerHTML = html || '<div>No data found.</div>';
    }

    reloadData();
  </script>

  <style>
    body { font-family: system-ui, sans-serif; margin: 0; }
    main { padding: 1rem 2rem; }
    .selector, .display-options { margin-bottom: 1rem; }
    select { margin-left: 0.5rem; }
    .word-item { border-bottom: 1px solid #ddd; padding: 0.5rem 0; }
    .word-title { font-size: 1.1em; }
    .error { color: #c00; padding: 1rem; background: #fee; border-radius: 8px; }
  </style>

</body>
</html>
