<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>nihongotext.com</title>

<link rel="icon" href="/favicon.ico" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<!-- GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9QSHWJE0HZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-9QSHWJE0HZ');
</script>

<style>
:root{
  --shu:#e60012;          /* 朱（日本の赤） */
  --shu-tint:#f7d7da;     /* 赤系うすめ */
  --ink:#222;
  --muted:#666;
  --line:#e8e8e8;
  --bg:#fffdfc;
  --card:#fff7f6;
}
*{box-sizing:border-box}
html,body{
  margin:0;background:#fff;color:var(--ink);
  font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Sans","Hiragino Kaku Gothic ProN","Yu Gothic UI","Meiryo",sans-serif
}
a{color:inherit;text-decoration:none}
button{cursor:pointer}

/* Header */
.topbar{border-top:4px solid var(--shu);border-bottom:1px solid var(--shu-tint);background:#fff}
.wrap{max-width:1100px;margin:0 auto;padding:0 16px}
.brandbar{display:flex;gap:14px;align-items:center;padding:14px 0}
.brand{font-weight:900;font-size:40px;color:var(--shu);}
.small-dot{font-weight:400;font-size:.6em;color:#000}
.brand a{display:inline-block}
.nav{margin-left:auto;display:flex;gap:12px;align-items:center}
.nav a,.nav button{border:1px solid var(--line);padding:8px 12px;border-radius:10px;background:#fff}
.nav .primary{border-color:var(--shu);color:#fff;background:var(--shu);}

/* Body */
main.wrap{display:block;padding:20px 0}
.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:10px 0 14px}
.controls .grow{flex:1 1 260px}
select, input[type="text"]{border:1px solid var(--line);border-radius:8px;padding:8px 10px;width:100%}
.grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
@media (max-width:800px){ .grid{grid-template-columns:1fr} }

.card{border:2px solid var(--line);border-radius:14px;background:var(--card);padding:10px}
.card h3{font-size:18px;margin:0 0 6px}
.meta{font-size:12px;color:var(--muted);margin-bottom:6px}
.tools{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.btn{border:1px solid var(--line);padding:6px 10px;border-radius:10px;background:#fff}
.btn.primary{border-color:var(--shu);background:var(--shu);color:#fff}
.btn.secondary{background:#f6f6f6}
.btn.danger{border-color:#f66;color:#f66;background:#fff}
.tag{border:1px solid var(--line);border-radius:20px;padding:2px 8px;font-size:12px;background:#fff}
.chips{display:flex;flex-wrap:wrap;gap:6px}

/* field toggles */
.toggle-row{display:flex;flex-wrap:wrap;gap:14px;align-items:center}
.toggle-row label{display:flex;gap:6px;align-items:center}

/* pager */
.pager{display:flex;gap:8px;justify-content:center;margin:12px 0}
.pagebtn{border:1px solid var(--line);padding:6px 10px;border-radius:8px;background:#fff}

/* modal */
.ntx-modal{position:fixed;inset:auto 0 0 0;display:none;z-index:1000;background:#fff;border-top:3px solid var(--shu);max-height:92vh}
.ntx-modal.show{display:block}
.ntx-m-head{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 16px;border-bottom:1px solid var(--line)}
.ntx-m-title{font-weight:700}
.ntx-ctl{display:flex;gap:8px;align-items:center}
.ntx-m-body{padding:12px 16px;overflow:auto;max-height:calc(92vh - 56px)}
.ntx-table{width:100%;border-collapse:collapse}
.ntx-table th,.ntx-table td{border:1px solid #ddd;padding:6px 8px;text-align:left;vertical-align:top}
.ntx-table th{background:#fafafa}

.ntx-header{border-bottom:1px solid var(--shu-tint);background:#fff}
.ntx-wrap{max-width:1100px;margin:0 auto;padding:8px 16px;display:flex;align-items:center;gap:12px}
.ntx-right{margin-left:auto;display:flex;gap:8px;align-items:center}
.ntx-langbtn{border:1px solid var(--line);padding:6px 10px;border-radius:10px;background:#fff}

/* Learnクリック時の緑色枠（Learning状態） */
.card.learning{
  background:#f0fff4;
  border-color:#34d399;
}
</style>
</head>
<body>

<!-- Header -->
<div class="topbar">
  <header class="wrap brandbar ntx-header">
    <div class="ntx-wrap" id="site-header">
      <div class="brand">
        <a href="/" aria-label="Go to Home">
          <span>nihongotext</span><span class="small-dot">.com</span>
          <br><span style="font-size:12px;color:#444">== beta version ==</span>
        </a>
      </div>
      <nav class="nav">
        <button id="langBtn" class="secondary" type="button">日本語</button>
        <a href="/inquiry/" class="primary">Contact</a>
      </nav>
      <div class="ntx-right"></div>
    </div>
  </header>
</div>

<main class="wrap">

  <div class="controls">
    <label>Level
      <select id="levelSel">
        <option>N5</option>
        <option>N4</option>
        <option>N3</option>
        <option>N2</option>
        <option>N1</option>
      </select>
    </label>

    <div class="chips" id="posChips" role="tablist" aria-label="Parts of Speech"></div>

    <input id="kw" class="grow" type="text" placeholder="Search across all levels & parts…" />
    <button id="printBtn" class="btn" type="button">Print Learned</button>

    <div class="toggle-row" role="group" aria-label="Field toggles">
      <label><input type="checkbox" id="toggleEN" checked> English</label>
      <label><input type="checkbox" id="toggleJA" checked> Kanji</label>
      <label><input type="checkbox" id="toggleKANA" checked> Hiragana</label>
      <label><input type="checkbox" id="toggleRO" checked> Romaji</label>
    </div>
  </div>

  <div id="meta" style="color:var(--muted);font-size:13px;margin:4px 0 10px"></div>
  <div id="list" class="grid" aria-live="polite"></div>
  <div id="pager" class="pager"></div>
</main>

<!-- Footer -->
<div class="footer">
  <div id="site-footer" class="wrap footer-inner">© 2025 nihongotext.com</div>
</div>

<!-- Learned モーダル -->
<div id="learnedModal" class="ntx-modal" role="dialog" aria-label="learned-list" aria-modal="true">
  <div class="ntx-m-head">
    <div class="ntx-m-title" id="learnedTitle">Learned</div>
    <div class="ntx-ctl">
      <button class="btn" id="printLearned">Print</button>
      <button class="btn secondary" id="goToLearning">go to learning</button>
      <button class="xbtn" data-close="learnedModal" aria-label="Close">×</button>
    </div>
  </div>
  <div class="ntx-m-body">
    <table class="ntx-table" id="learnedTable">
      <thead>
        <tr>
          <th>#</th><th data-i18n="word">Word</th><th>Level/Part</th>
          <th data-i18n="moved">Moved on</th>
          <th data-i18n="examples">Examples</th>
          <th class="quizstat" data-i18n="quiz">Quiz</th>
          <th data-i18n="action">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<!-- ===== BEGIN: Learning / Learned UI injection ===== -->
<div id="ntxModalMask" style="display:none"></div>
<div id="learningModal" class="ntx-modal" role="dialog" aria-label="learning">
  <div class="ntx-m-head">
    <div class="ntx-m-title" data-i18n="learning_title">learning</div>
    <div class="ntx-ctl">
      <button class="btn" id="printLearning" data-i18n="print">Print</button>
      <button class="btn secondary" id="goToLearned" data-i18n="goto_learned">go to learned</button>
      <button class="xbtn" data-close="learningModal" aria-label="Close">×</button>
    </div>
  </div>
  <div class="ntx-m-body">
    <table class="ntx-table" id="learningTable">
      <thead>
        <tr>
          <th>#</th><th data-i18n="word">Word</th><th>Level/Part</th>
          <th data-i18n="moved">Moved on</th>
          <th data-i18n="examples">Examples</th>
          <th class="quizstat" data-i18n="quiz">Quiz</th>
          <th data-i18n="action">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<!-- learned（覚えた） -->
<div id="learnedModal" class="ntx-modal" role="dialog" aria-label="learned">
  <div class="ntx-m-head">
    <div class="ntx-m-title" data-i18n="learned_title">learned</div>
    <div class="ntx-ctl">
      <button class="btn" id="printLearned" data-i18n="print">Print</button>
      <button class="btn secondary" id="goToLearning" data-i18n="goto_learning">go to learning</button>
      <button class="xbtn" data-close="learnedModal" aria-label="Close">×</button>
    </div>
  </div>
  <div class="ntx-m-body">
    <table class="ntx-table" id="learnedTable">
      <thead>
        <tr>
          <th>#</th><th data-i18n="word">Word</th><th>Level/Part</th>
          <th data-i18n="moved">Moved on</th>
          <th data-i18n="examples">Examples</th>
          <th class="quizstat" data-i18n="quiz">Quiz</th>
          <th data-i18n="action">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
/* ========= i18n ========= */
function ntxLang(){ try{return localStorage.getItem('lang')||'en'}catch(_){return'en'} }
function i18n(tk){
  const ja={learning_title:'学習中（learning）', learned_title:'覚えた（learned）', word:'単語', moved:'移動日', examples:'例文', quiz:'クイズ', action:'操作', learn:'覚える'};
  const en={learning_title:'learning', learned_title:'learned', word:'Word', moved:'Moved on', examples:'Examples', quiz:'Quiz', action:'Action', learn:'Learn'};
  return (ntxLang()==='ja'?ja:en)[tk]||tk;
}
function applyI18n(){
  document.querySelectorAll('[data-i18n]').forEach(el=>{ el.textContent=i18n(el.getAttribute('data-i18n')); });
  const lb=document.getElementById('learnBtn'); if(lb) lb.textContent=(ntxLang()==='ja'?'学習中':'Learning');
}

/* ========= ストレージ ========= */
const NTX_KEYS={learning:'ntx_learning_v2', learned:'ntx_learned_v2'};
function ntxLoad(k){ try{return JSON.parse(localStorage.getItem(k)||'[]')}catch(_){return[]} }
function ntxSave(k,v){ try{localStorage.setItem(k,JSON.stringify(v))}catch(_){} }
function today(){ const d=new Date(),z=n=>String(n).padStart(2,'0'); return `${d.getFullYear()}-${z(d.getMonth()+1)}-${z(d.getDate())}`; }
function upsert(k,item){ const a=ntxLoad(k); const i=a.findIndex(x=>x.id===item.id); if(i>=0)a[i]=item; else a.push(item); ntxSave(k,a); }
function removeFrom(k,id){ ntxSave(k, ntxLoad(k).filter(x=>x.id!==id)); }

/* ========= 公開 API =========
  item: { id, ja, en, level, part, movedAt?, examples?:[{en,ja,kana,ro}], quiz?:{taken,correct} }
*/
window.ntxToLearning=function(item){ if(!item||!item.id)return; item.movedAt=item.movedAt||today(); item.quiz=item.quiz||{taken:0,correct:0}; upsert(NTX_KEYS.learning,item); removeFrom(NTX_KEYS.learned,item.id); renderLearning(); };
window.ntxToLearned=function(item){ if(!item||!item.id)return; item.movedAt=item.movedAt||today(); item.quiz=item.quiz||{taken:0,correct:0}; upsert(NTX_KEYS.learned,item); removeFrom(NTX_KEYS.learning,item.id); renderLearned(); };
window.ntxQuizAddResult=function(id,correct){
  [NTX_KEYS.learning,NTX_KEYS.learned].forEach(k=>{
    const a=ntxLoad(k), i=a.findIndex(x=>x.id===id);
    if(i>=0){ a[i].quiz=a[i].quiz||{taken:0,correct:0}; a[i].quiz.taken++; if(!!correct) a[i].quiz.correct++; ntxSave(k,a); }
  });
  renderLearning(); renderLearned();
};

/* ========= 行レンダリング ========= */
function escapeHtml(s){ return (s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[m]); }
function quizText(q){ q=q||{taken:0,correct:0}; return `${q.correct||0}/${q.taken||0}`; }
function examplesHtml(exs){ if(!exs||!exs.length) return '-'; return '<details open><summary>…</summary>'+exs.map(e=>`
  <div><span>${escapeHtml(e.en||'')}</span>
  ${e.ja?`<div>${escapeHtml(e.ja)}</div>`:''}
  ${e.kana?`<div>${escapeHtml(e.kana)}</div>`:''}
  ${e.ro?`<div>${escapeHtml(e.ro)}</div>`:''}
  </div>`).join('')+'</details>'; }

function rowHTML(idx, it, toKey){
  const meta=[it.level||'', it.part||''].filter(Boolean).join(' / ');
  const examples=examplesHtml(it.examples);
  const to = (toKey===NTX_KEYS.learned?'learned':'learning');
  const isToLearned = (toKey===NTX_KEYS.learned);
  const moveLabel = isToLearned ? (ntxLang()==='ja'?'Learned':'Learned') : (ntxLang()==='ja'?'Learning':'Learning');
  const fn = (toKey===NTX_KEYS.learned?'window.ntxToLearned':'window.ntxToLearning');
  const payload = encodeURIComponent(JSON.stringify(it));
  return `<tr>
    <td>${idx+1}</td>
    <td><strong>${escapeHtml(it.ja||it.en||it.id||'-')}</strong><br/><span style="color:#666">${escapeHtml(it.en||'')}</span></td>
    <td>${meta||'-'}</td>
    <td>${it.movedAt||'-'}</td>
    <td>${examples}</td>
    <td class="quizstat">${quizText(it.quiz)}</td>
    <td>
      <button class="btn" onclick="(function(){ ${fn}(JSON.parse(decodeURIComponent('${payload}'))); })()">${moveLabel}</button>
      <button class="btn danger" onclick="(function(){ removeFrom('${toKey}','${it.id}'); renderLearning(); renderLearned(); })()">
        ${ntxLang()==='ja'?'削除':'remove'}
      </button>
    </td>
  </tr>`;
}
function renderLearning(){ const tb=document.querySelector('#learningTable tbody'); if(!tb)return; const a=ntxLoad(NTX_KEYS.learning); tb.innerHTML = a.map((x,i)=>rowHTML(i,x,NTX_KEYS.learned)).join('')||`<tr><td colspan="7">No items</td></tr>`; applyI18n(); }
function renderLearned(){ const tb=document.querySelector('#learnedTable tbody'); if(!tb)return; const a=ntxLoad(NTX_KEYS.learned);  tb.innerHTML = a.map((x,i)=>rowHTML(i,x,NTX_KEYS.learning)).join('')||`<tr><td colspan="7">No items</td></tr>`; applyI18n(); }

/* ========= 開閉・印刷 ========= */
function openModal(id){ document.getElementById('ntxModalMask')?.classList.add('show'); document.getElementById(id)?.classList.add('show'); if(id==='learningModal')renderLearning(); if(id==='learnedModal')renderLearned(); }
function closeModal(id){ document.getElementById(id)?.classList.remove('show'); document.getElementById('ntxModalMask')?.classList.remove('show'); }
function printTable(id){
  const box=document.querySelector('#'+id+' .ntx-m-body'); if(!box)return;
  const w=window.open('','_blank');
  w.document.write('<meta charset="utf-8"><title>Print</title><style>body{font:14px/1.5 -apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.5;} h1{font-size:18px} table{width:100%;border-collapse:collapse}th,td{border:1px solid #ddd;padding:6px 8px;text-align:left} details{margin:.2rem 0} summary{font-weight:700}</style>'+box.innerHTML);
  w.document.close(); w.focus(); w.print(); w.close();
}

/* ========= ヘッダー統合（learn ボタンを右端に） ========= */
document.addEventListener('DOMContentLoaded', function(){
  // ヘッダー右側コンテナが無い場合は作る
  let right=document.querySelector('.ntx-header .ntx-right'); const wrap=document.querySelector('.ntx-header .ntx-wrap');
  if(!right && wrap){ right=document.createElement('div'); right.className='ntx-right'; wrap.appendChild(right); }
  // learn ボタン（学習中を開く）
  if(right && !document.getElementById('learnBtn')){
    const btn=document.createElement('button'); btn.id='learnBtn'; btn.className='ntx-langbtn'; btn.type='button'; btn.textContent=(ntxLang()==='ja'?'学習中':'Learning'); btn.setAttribute('aria-label','learn'); right.prepend(btn);
  }
  document.getElementById('learnBtn')?.addEventListener('click', ()=>openModal('learningModal'));

  // モーダル内ナビ
  document.getElementById('goToLearned') ?.addEventListener('click', ()=>{ closeModal('learningModal'); openModal('learnedModal'); });
  document.getElementById('goToLearning')?.addEventListener('click', ()=>{ closeModal('learnedModal');  openModal('learningModal'); });
  // 閉じる
  document.querySelectorAll('.xbtn[data-close]').forEach(b=>b.addEventListener('click', ()=>closeModal(b.getAttribute('data-close'))));
  document.getElementById('ntxModalMask')?.addEventListener('click', ()=>{ closeModal('learningModal'); closeModal('learnedModal'); });
  // 印刷
  document.getElementById('printLearning')?.addEventListener('click', ()=>printTable('learningModal'));
  document.getElementById('printLearned') ?.addEventListener('click', ()=>printTable('learnedModal'));

  applyI18n();
});
</script>
<!-- ===== END: Learning / Learned UI injection ===== -->

<script>
/* ===========================================================
   以下はメインリスト描画や検索等の既存ロジック（抜粋）
   - Learn クリック時の処理を上書き済み（緑枠 & 例文クローズ）
   =========================================================== */

/* ダミーデータ／実データ読込は既存処理を使用 */
const POS=[{k:'nouns',enLabel:'Nouns'},{k:'verbs',enLabel:'Verbs'},{k:'iadj',enLabel:'Adjectives-i'},{k:'naadj',enLabel:'Adjectives-na'},{k:'adverbs',enLabel:'Adverbs'},{k:'conj',enLabel:'Conjunctions'},{k:'interj',enLabel:'Interjections'},{k:'numerals',enLabel:'Numerals'},{k:'particles',enLabel:'Particles'}];

let level='N5';
let posKey='nouns';
let page=1;
let lastData=[];
const PAGE_SIZE=20;

const levelSel=document.getElementById('levelSel');
const posChips=document.getElementById('posChips');
const list=document.getElementById('list');
const pager=document.getElementById('pager');
const kw=document.getElementById('kw');
const meta=document.getElementById('meta');

function setLang(l){ try{localStorage.setItem('lang',l)}catch(_){ } applyI18n(); renderList(lastData,true); }
document.getElementById('langBtn').addEventListener('click', ()=>{
  const cur=ntxLang(); setLang(cur==='ja'?'en':'ja');
  document.getElementById('langBtn').textContent=(ntxLang()==='ja'?'English':'日本語');
});

function chip(label, key){ const b=document.createElement('button'); b.textContent=label; b.className='btn'; b.onclick=()=>{ posKey=key; page=1; if(!kw.value.trim()) loadSingleAndRender(); else onSearchInput(); }; return b; }
function buildChips(){ posChips.innerHTML=''; POS.forEach(p=>posChips.appendChild(chip(p.enLabel, p.k))); }
buildChips();

function onSearchInput(){ /* 実装は既存の検索を使用 */ renderList(lastData,true); }
kw.addEventListener('input', onSearchInput);

const toggleEN   = document.getElementById('toggleEN');
const toggleJA   = document.getElementById('toggleJA');
const toggleKANA = document.getElementById('toggleKANA');
const toggleRO   = document.getElementById('toggleRO');
[toggleEN,toggleJA,toggleKANA,toggleRO].forEach(el=>el.addEventListener('change',()=>renderList(lastData)));

document.getElementById('levelSel').addEventListener('change', e=>{
  level=e.target.value; page=1; if(!kw.value.trim()) loadSingleAndRender(); else onSearchInput();
});
document.getElementById('printBtn').addEventListener('click', ()=>openModal('learnedModal'));

function pageBtn(t,fn){const b=document.createElement('button');b.className='pagebtn';b.textContent=t;b.onclick=fn;return b;}
function paginate(data){
  const total=Math.max(1,Math.ceil(data.length/PAGE_SIZE));
  if(page>total)page=total;
  const start=(page-1)*PAGE_SIZE;
  const rows=data.slice(start,start+PAGE_SIZE);
  pager.innerHTML='';
  const prev=pageBtn('Prev',()=>{page--;renderList(lastData,true);});
  prev.disabled=(page<=1);
  const next=pageBtn('Next',()=>{page++;renderList(lastData,true);});
  next.disabled=(page>=total);
  pager.append(prev,document.createTextNode(` ${page}/${total} `),next);
  return rows;
}

/* ======= デモ用のレンダリング（実運用ではJSON読み込みに置換） ======= */
function demoData(){
  // 実運用では fetch(`/data/json/${level}/nouns.json`) のように差し替え
  return [
    {id:'n5-001', ja:'計画', en:'plan', examples:[{en:'We have a plan.',ja:'計画があります。',kana:'けいかく が あります。',ro:'keikaku ga arimasu.'}]},
    {id:'n5-002', ja:'始める', en:'start', examples:[{en:'Let’s start now.',ja:'今から始めましょう。',kana:'いま から はじめましょう。',ro:'ima kara hajimemashou.'}]}
  ];
}

/* ==== リスト描画 ==== */
function renderList(data, scrollTop){
  lastData=data;
  const rows=paginate(data);
  list.innerHTML='';
  rows.forEach(item=>{
    const card=document.createElement('div'); card.className='card';
    const head=document.createElement('div');
    const h3=document.createElement('h3'); h3.textContent=`${item.ja||item.en||item.id}`;
    const metaEl=document.createElement('div'); metaEl.className='meta'; metaEl.textContent=`${level} / ${POS.find(p=>p.k===posKey)?.enLabel||posKey}`;
    head.append(h3,metaEl);

    const body=document.createElement('div'); body.innerHTML = (item.examples||[]).map(e=>`
      <div style="padding:6px 0;border-top:1px dashed #ddd">
        <div>${escapeHtml(e.en||'')}</div>
        ${e.ja?`<div>${escapeHtml(e.ja)}</div>`:''}
        ${e.kana?`<div>${escapeHtml(e.kana)}</div>`:''}
        ${e.ro?`<div>${escapeHtml(e.ro)}</div>`:''}
      </div>`).join('') || '<div style="color:#777">-</div>';

    const tools=document.createElement('div'); tools.className='tools';
    const tog=document.createElement('button'); tog.className='btn'; tog.textContent='▲'; tog.setAttribute('aria-expanded','true');
    const act=document.createElement('button'); act.className='btn primary'; act.textContent=(ntxLang()==='en'?'Learn':'覚える');

    // ==== Learn ボタン（Learning へ移動）====
    act.textContent = (ntxLang()==='en'?'Learn':'覚える');
    act.onclick = () => {
      const posLabel = POS.find(p=>p.k===posKey)?.enLabel || posKey;
      const payload = {
        id: item.id, ja: item.ja, en: item.en,
        level, part: posLabel,
        examples: item.examples || [],
        quiz: {taken:0, correct:0}
      };
      // 1) Learningへ保管
      window.ntxToLearning(payload);
      // 2) カードUI更新: 緑枠 + 例文を閉じる
      card.classList.add('learning');
      if (body) body.style.display = 'none';
      tog.textContent = '▼';
      tog.setAttribute('aria-expanded','false');
    };

    // ==== トグル ====
    tog.addEventListener('click',()=>{
      const open = body.style.display!=='none';
      if(open){
        body.style.display='none'; tog.textContent='▼'; tog.setAttribute('aria-expanded','false');
      }else{
        body.style.display='';    tog.textContent='▲'; tog.setAttribute('aria-expanded','true');
      }
    });

    tools.append(tog, act);
    card.append(head,body,tools);
    list.appendChild(card);
  });

  if(scrollTop){ window.scrollTo({top:0,behavior:'smooth'}); }
  meta.textContent = `${data.length} items`;
}

/* ==== 初期化 ==== */
function loadSingleAndRender(){ const data=demoData(); renderList(data,true); }
loadSingleAndRender();
</script>

</body>
</html>
