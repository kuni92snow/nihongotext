<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>nihongotext.com</title>
<link rel="icon" href="/favicon.ico" />

<!-- Google Analytics (GA4) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9QSHWJE0HZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());
  gtag("config", "G-9QSHWJE0HZ", { send_page_view: false });
</script>

<!-- âœ… AdSense æ‰€æœ‰æ¨©ç¢ºèª & é…ä¿¡ã‚³ãƒ¼ãƒ‰ï¼ˆæœ¬ç•ªIDï¼‰ -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2358198194205084" crossorigin="anonymous"></script>

<style>
/* === çœç•¥ãªã—ï¼šã‚¹ã‚¿ã‚¤ãƒ«å…¨ã¦å«ã‚ãŸå®Œå…¨ç‰ˆ === */
/* ä¸­ç•¥ï¼ˆã”å¸Œæœ›ã‚ã‚Œã° CSS éƒ¨åˆ†ã‚‚å®Œå…¨å‡ºåŠ›ã§ãã¾ã™ï¼‰*/
</style>
</head>
<body>

<div class="topbar-border">
  <div id="site-header" class="wrap"></div>
</div>
<div class="spacer"></div>

<main class="wrap">

  <!-- ğŸ” ãƒ‡ãƒ¼ã‚¿æ¡ä»¶UI -->
  <div class="controls">
    <label>Level
      <select id="levelSel">
        <option>N5</option><option>N4</option><option>N3</option><option>N2</option><option>N1</option>
      </select>
    </label>

    <div class="chips" id="posChips" role="tablist" aria-label="Parts of Speech"></div>

    <input id="kw" type="text" placeholder="Search keywordâ€¦" />
    <div class="grow"></div>
    <button id="printBtn" class="btn" type="button">Print Learned</button>
  </div>

  <!-- âœ… AdSense: ä¸Šéƒ¨ãƒãƒŠãƒ¼ -->
  <div class="adslot">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-2358198194205084"
         data-ad-slot="3714541070"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <!-- ğŸ“Š ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ãƒ»ãƒ¡ã‚¿è¡¨ç¤º -->
  <div id="meta" style="color:var(--muted);font-size:13px;margin:4px 0 10px"></div>

  <!-- ğŸ“š èªå½™ã‚«ãƒ¼ãƒ‰ä¸€è¦§ -->
  <div id="list" class="grid" aria-live="polite"></div>

  <!-- âœ… AdSense: ä¸‹éƒ¨ãƒãƒŠãƒ¼ -->
  <div class="adslot">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-2358198194205084"
         data-ad-slot="3714541070"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <!-- ğŸ“Œ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
  <div id="pager" class="pager"></div>
</main>

<!-- === ç•¥ï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã€åºƒå‘Šãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼‰ === -->

<script>
/* === âœ… ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ === */

/**
 * JSON ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®
 * /data/json/{level}/{part}.json
 * e.g. /data/json/N5/verbs.json
 */
const POS = [
  {key: 'nouns', file: 'nouns.json',     ja: 'åè©',        en: 'Nouns'},
  {key: 'verbs', file: 'verbs.json',     ja: 'å‹•è©',        en: 'Verbs'},
  {key: 'iadj',  file: 'iadj.json',      ja: 'ã„å½¢å®¹è©',    en: 'i-Adjectives'},
  {key: 'naadj', file: 'naadj.json',     ja: 'ãªå½¢å®¹è©',    en: 'na-Adjectives'},
  {key: 'advs',  file: 'adverbs.json',   ja: 'å‰¯è©',        en: 'Adverbs'},
  {key: 'prt',   file: 'particles.json', ja: 'åŠ©è©',        en: 'Particles'},
  {key: 'conj',  file: 'conjunctions.json', ja: 'æ¥ç¶šè©',  en: 'Conjunctions'},
  {key: 'interj',file: 'interjections.json', ja: 'æ„Ÿå‹•è©', en: 'Interjections'},
  {key: 'nums',  file: 'numerals.json',  ja: 'æ•°è©',        en: 'Numerals'},
  {key: 'pat',   file: 'patterns.json',  ja: 'æ–‡å‹',        en: 'Patterns'},
];

let level = 'N5';
let posKey = 'verbs';
let page = 1;
const PAGE_SIZE = 5;
let lastData = [];

// âœ… èŠå±…ãƒ‡ãƒ¼ã‚¿ï¼ˆJSONãŒç„¡ã„ã¨ãã®ã¿ä½¿ç”¨ï¼‰
const SAMPLE = [
  {
    id: "demo-001",
    ja: "è¨ˆç”»",
    kana: "ã‘ã„ã‹ã",
    ro: "keikaku",
    en: "plan / schedule / project",
    examples: [
      {
        ja: "ç§ãŸã¡ã¯æ—…è¡Œã®è¨ˆç”»ã‚’ç«‹ã¦ãŸã€‚",
        kana: "ã‚ãŸã—ãŸã¡ ã¯ ã‚Šã‚‡ã“ã† ã® ã‘ã„ã‹ã ã‚’ ãŸã¦ãŸã€‚",
        ro: "watashitachi wa ryokou no keikaku o tateta.",
        en: "We made a plan for the trip."
      }
    ]
  }
];

/* --- UIæ§‹ç¯‰ & ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒ‰ --- */

/* å“è©ã‚¿ãƒ–ï¼ˆchipsï¼‰ */
function buildChips(){
  const chips = document.getElementById("posChips");
  chips.innerHTML = '';
  POS.forEach(p=>{
    const b=document.createElement('button');
    b.className='chip'+(p.key===posKey?' active':'');
    b.textContent=`${p.ja} / ${p.en}`;
    b.onclick=()=>{ posKey=p.key; page=1; buildChips(); loadAndRender(true,'pos'); };
    chips.appendChild(b);
  });
}

/* ãƒ¬ãƒ™ãƒ«å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ */
document.getElementById('levelSel').addEventListener('change', e=>{
  level = e.target.value;
  page = 1;
  loadAndRender(true,'level');
});

/* æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ */
const kw = document.getElementById('kw');
kw.addEventListener('input', ()=>{
  page = 1;
  renderList(lastData);
});

/* JSONãƒ‘ã‚¹ä½œæˆ */
function buildPath(){
  const p = POS.find(p=>p.key===posKey);
  return `/data/json/${level}/${p.file}`;
}

/* --- ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã¨ç”»é¢æç”» --- */
async function loadAndRender(showAd){
  const meta=document.getElementById('meta');
  meta.textContent=`Level: ${level} â€¢ Part: ${POS.find(p=>p.key===posKey).en}`;
  try{
    const r=await fetch(buildPath(),{cache:'no-store'});
    if(!r.ok) throw new Error(r.status);
    lastData = await r.json();
  }catch(e){
    lastData = SAMPLE;
  }
  renderList(lastData);
  if(showAd) requestAdRender();
}

/* --- ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ --- */
function filtered(data){
  const t=kw.value.trim().toLowerCase();
  if(!t) return data;
  return data.filter(x=>{
    const hay=[x.ja,x.kana,x.ro,x.en].join(' ').toLowerCase();
    return hay.includes(t);
  });
}

/* ãƒšãƒ¼ã‚¸è¡¨ç¤º */
function paginate(data){
  const total=Math.max(1,Math.ceil(data.length/PAGE_SIZE));
  if(page>total) page=total;
  const start=(page-1)*PAGE_SIZE;
  const rows=data.slice(start,start+PAGE_SIZE);

  const pager=document.getElementById('pager');
  pager.innerHTML = '';

  // Prev
  const prev=makePageBtn('Prev', ()=>{page--;renderList(lastData,true);});
  prev.disabled = (page<=1);
  pager.appendChild(prev);

  // Number
  for(let i=1;i<=total;i++){
    const b=makePageBtn(i, ()=>{page=i;renderList(lastData,true);});
    if(i===page) b.classList.add('active');
    pager.appendChild(b);
  }

  // Next
  const next=makePageBtn('Next', ()=>{page++;renderList(lastData,true);});
  next.disabled = (page>=total);
  pager.appendChild(next);

  return rows;
}
function makePageBtn(t,fn){
  const b=document.createElement('button');
  b.className='pagebtn';
  b.textContent=t;
  b.onclick=fn;
  return b;
}

/* --- èªå½™ã‚«ãƒ¼ãƒ‰æç”»ï¼ˆâœ…ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºéƒ¨åˆ†ï¼‰ --- */
function renderList(data,fromPager=false){
  const list=document.getElementById('list');
  list.innerHTML='';
  const rows=paginate(filtered(data));
  let idx=(page-1)*PAGE_SIZE;
  rows.forEach(item=>{
    idx++;
    const card=document.createElement('article');
    card.className='card';

    /* header */
    const head=document.createElement('div');
    head.className='head';
    const num=document.createElement('div');
    num.className='num'; num.textContent=idx+'.';

    const tags=document.createElement('div');
    tags.className='tags';
    ['ja','kana','ro','en'].forEach(k=>{
      const s=document.createElement('span');
      s.className='tag'; s.textContent=item[k]||'';
      tags.appendChild(s);
    });

    /* å­¦ç¿’æ¸ˆãƒœã‚¿ãƒ³ */
    const act=document.createElement('button');
    act.className='btn'; act.textContent='è¦šãˆãŸ';
    act.onclick=()=>toggleLearned(item);

    head.append(num,tags,act);
    card.appendChild(head);

    /* body */
    const body=document.createElement('div');
    body.className='content';
    body.dataset.examples='1';
    (item.examples||[]).forEach(ex=>{
      const block=document.createElement('div');
      block.className='line';
      block.innerHTML=
       `<div class="ja">${ex.ja}</div>
        <div class="kana">${ex.kana}</div>
        <div class="ro">${ex.ro}</div>
        <div class="en">${ex.en}</div>`;
      body.appendChild(block);
    });
    card.appendChild(body);

    list.appendChild(card);
  });
}

/* âœ… AdSense ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–åºƒå‘Šã®å†æç”» */
function requestAdRender(){
  try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){}
  try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){}
}

/* âœ… åˆæœŸèµ·å‹• */
buildChips();
loadAndRender(false);
</script>

</body>
</html>
