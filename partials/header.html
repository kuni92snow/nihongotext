<!-- /partials/header.html -->
<header>
  <!-- GA4（重複ロード防止） -->
  <script>
    (function(){
      if(!window.__gaLoaded){
        var s=document.createElement('script');
        s.async=true; s.src='https://www.googletagmanager.com/gtag/js?id=G-9QSHWJE0HZ';
        document.head.appendChild(s);
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        window.gtag = gtag;
        gtag('js', new Date());
        gtag('config', 'G-9QSHWJE0HZ', { send_page_view:false });
        window.__gaLoaded = true;
      }
    })();
  </script>

  <!-- AdSense（重複ロード防止） -->
  <script>
    (function(){
      if(!window.__adsenseLoaded){
        var s=document.createElement('script');
        s.async=true;
        s.src='https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2358198194205084';
        s.crossOrigin='anonymous';
        document.head.appendChild(s);
        window.__adsenseLoaded = true;
      }
    })();
  </script>

  <!-- 上段：ロゴ＋言語切替 -->
  <div class="brandbar" style="border-bottom:4px solid #e4573d;padding:16px 0 8px">
    <div class="site-wrap" style="max-width:980px;margin:0 auto;padding:0 20px;display:flex;gap:12px;align-items:center">
      <a href="/" class="brand" style="font-weight:800;font-size:22px;letter-spacing:.2px;color:#e4573d;text-decoration:none;display:flex;align-items:center;gap:10px">
        <span>nihongotext<span style="color:#000">.com</span></span>
        <small style="font-weight:600;color:#888">== beta version ==</small>
      </a>
      <button id="langBtn" class="lang-toggle" style="margin-left:auto;border:1px solid #e4573d;color:#e4573d;background:#fff;border-radius:8px;padding:6px 12px;cursor:pointer">
        日本語
      </button>
    </div>
  </div>

  <!-- 下段：アイコン列（絶対パス/外部CDNでどの階層でも表示） -->
  <nav class="iconbar" style="display:flex;gap:14px;align-items:center;justify-content:center;padding:10px 0 14px;border-bottom:2px solid #f4b2a6">
    <a class="iconbtn" href="javascript:window.print()" title="Print" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="print" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/printer.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="/inquiry/" title="Contact" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="contact" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/mail.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="/learned/" title="Learned list" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="learned" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/list-check.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="/blog/" title="Blog" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="blog" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/notebook.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="https://www.reddit.com/" target="_blank" rel="noopener" title="Reddit" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="reddit" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/brand-reddit.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="https://medium.com/" target="_blank" rel="noopener" title="Medium" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="medium" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/brand-medium.svg" width="18" height="18">
    </a>
    <a class="iconbtn" href="https://substack.com/" target="_blank" rel="noopener" title="Substack" style="display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border:1px solid #f4b2a6;border-radius:999px;background:#fff">
      <img alt="substack" src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/brand-substack.svg" width="18" height="18">
    </a>
  </nav>

  <!-- 言語切替：現在のURLを保って ?lang=ja / en をトグル -->
  <script>
    (function(){
      var btn = document.getElementById('langBtn');
      if(!btn) return;
      var url = new URL(location.href);
      var lang = (url.searchParams.get('lang')||'en').toLowerCase();
      // ボタン表示（今の表示言語に応じた“切替先”を見せる）
      btn.textContent = (lang==='ja') ? 'English' : '日本語';

      btn.addEventListener('click', function(){
        var u = new URL(location.href);
        var current = (u.searchParams.get('lang')||'en').toLowerCase();
        u.searchParams.set('lang', current==='ja' ? 'en' : 'ja');
        // ページビューは手動送信（SPA的遷移を想定）
        if(window.gtag){
          gtag('event','page_view', { page_location: u.toString() });
        }
        location.href = u.toString();
      });
    })();
  </script>
</header>
